<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="css/player.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/header.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" asp-append-version="true" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player</title>
</head>
<body>
   
    <div class="player">
        <div class="player_body">
            <div class="side_bar_home">
            <img style="width: 70px;" src="https://cdn.freebiesupply.com/logos/thumbs/2x/gitlab-logo.png" alt="">
                <div class="sidebar_option">
                    <i class="fas fa-home"></i> <p>
                        Home
                    </p>

                </div>
                <div class="sidebar_option">
                    <i class="fas fa-search"></i><p>Search</p>

                </div>
                <div class="sidebar_option">
                    <i class="fas fa-swatchbook"></i> <p>
                        Your Library
                    </p>

                </div>
                <br />
                <strong class="sidebar_tittle"> PLAYLIST </strong>
                <hr/>
                <div class="sidebar_option">
                    <i class="fas fa-plus-square"></i> <p>
                        Add new playlist
                    </p>

                </div>
                <div class="sidebar_option">
                    <i class="fas fa-record-vinyl"></i> <p>
                        Hip hop
                    </p>

                </div>
                <div class="sidebar_option">
                    <i class="fas fa-record-vinyl"></i><p>
                        Hip hop
                    </p>

                </div>
                <div class="sidebar_option">
                    <i class="fas fa-record-vinyl"></i><p>
                        Hip hop
                    </p>

                </div>
                <div class="sidebar_option">
                    <i class="fas fa-record-vinyl"></i><p>
                        Hip hop
                    </p>

                </div>
                <div class="sidebar_option">
                    <i class="fas fa-record-vinyl"></i><p>
                        Hip hop
                    </p>

                </div>
                <div class="sidebar_option">
                    <i class="fas fa-record-vinyl"></i><p>
                        Hip hop
                    </p>

                </div>
                <div class="sidebar_option">
                    <i class="fas fa-record-vinyl"></i><p>
                        Hip hop
                    </p>

                </div>
            </div>
            <div class="colection_body">
                <div class="collection_header">
                    <div class="header_left">
                        <i class="fas fa-chevron-circle-left fa-3x" style="color:black"></i>
                    </div>
                    <div class="header_right">
                        <i class="fas fa-user-circle fa-3x"></i>
                        <h4>User's name</h4>
                    </div>
                </div>
                <div class="body_info">
                    <img src="https://community.spotify.com/t5/image/serverpage/image-id/60013i7710A8EFA4ECD096/image-size/large?v=v2&px=999" />
                    <div class="body_info_text">
                        <strong>PLAYLIST</strong>
                        <h2>DISCOVERY WEEKLY</h2>
                        <p>Description...</p>
                    </div>
                </div>
                <div class="body_songs">
                    <div class="body_song_icon">
                        <i class="fas fa-play-circle fa-5x" id="playlist_body_suffle" style="color: green;"></i>
                        <i class="fas fa-heart fa-2x"></i>
                        <i class="fas fa-ellipsis-h fa-2x"></i>
                    </div>
                    <div class="playlist_song">
                    </div>
                    
                 </div>
            </div>
        </div>
        <div class="player_footer">
            <div class="footer_left">
                <img class="song_playing" src="https://upload.wikimedia.org/wikipedia/vi/4/4b/Ariana_Grande_-_Dangerous_Woman_%28Official_Album_Cover%29.png" />
                <div class="song_info">
                    <h4 id="my_tittle"></h4>
                    <p id="my_artis"></p>
                </div>
            </div>
            <div class="footer_center">
                <div class="control_bar">
                <i class="fas fa-random fa-2x active" id="control_green"></i>
                <i class="fas fa-step-backward fa-2x" id="control_icon"></i>
                <div class="play_button">
                    <i class="far fa-play-circle fa-5x " id="control_icon"></i>
                    <i class="fas fa-pause-circle fa-5x my pause"></i>
                </div>
                
               
                <i class="fas fa-step-forward fa-2x" id="control_icon"></i>
                <i class="fas fa-redo fa-2x" id="control_green"></i>
                </div>
                <div class="progress-container">
                    <span id="start_time"></span>
                    <div class="progress-bar">
                        <div class="progress" id="progress"></div>
                        <audio id="audio" src=""></audio>
                    </div>
                    <span id="end_time"></span>
                </div>   
            </div>
            <div class="footer_right">
                <i class="fas fa-list-ul fa-2x"></i>
                <i class="fas fa-volume-up fa-2x"></i>
                <div class="input-div">
                    <div class="volumn-input-div">
                        <input type="range" value="100" step="5">
                        <div class="volume-progress"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>


<!-- Player Process -->
<script>
    const playlist = $('.playlist_song');
    const player_tittle = $('#my_tittle')
    const player_thumb = $('.song_playing')
    const player_artis = $('#my_artis')
    const audio = $('#audio')
    const playBtn = $('.play_button')
    const progress =$("#progress")
    const next_Btn = $('.fa-step-forward')
    const prev_Btn = $('.fa-step-backward')
    const random_Btn = $('.fa-random')
    var count=0;
const app={
  currentIndex:0,
  songs:[
    { 
    name:'Real love',
    singer:'My Anh, Khac Hung',
    path:'./music/Reallove.mp3',
    image:'https://static.yeah1.com/uploads/editors/26/2021/07/30/gGOSwwQVwszafKF3HJAHQ5klSWXu3ji7KSJhqttP.jpg'
  },
  {
    name:'Co em doi bong vui',
    singer:'Chillies',
    path:'./music/Chillies.mp3',
    image:'https://images.genius.com/5822e08274e4684b00a177ff3ef2f33e.551x551x1.jpg'
  },
  {
    name:'Huong',
    singer:'Van Mai Huong',
    path:'./music/Huong.mp3',
    image:'https://avatar-ex-swe.nixcdn.com/song/share/2021/01/22/7/e/7/0/1611280899564.jpg'
  },
  {
    name:'GENE',
    singer:'Binz',
    path:'./music/GENE.mp3',
    image:'https://tudienwiki.com/wp-content/uploads/2020/09/Binz.png'
  },
  {
    name:'Krazy',
    singer:'Binz',
    path:'./music/Krazy.mp3',
    image:'https://avatar-nct.nixcdn.com/mv/2018/02/02/a/5/2/9/1517539425061_640.jpg'
  },
  {
    name:'Phai Chang Em Da Yeu',
    singer:'Juky San',
    path:'./music/Phaichangemdayeu.mp3',
    image:'https://i1.sndcdn.com/artworks-zEUVw9b46Eu9qGYe-eATUzg-t500x500.jpg'
  },
  {
    name:'Thang nam',
    singer:'Soobin Hoang Son',
    path:'./music/Thangnam.mp3',
    image:'https://cdnmedia.thethaovanhoa.vn/Upload/3uPkfvAxvuOpUQrmKeiDaA/files/2021/08/B/22/playah_Fotor.jpg'
  },
  {
    name:'They Said',
    singer:'Binz',
    path:'./music/TheySaid.mp3',
    image:'https://i.ytimg.com/vi/XdBsAXOxYfo/hqdefault.jpg'
  }
],

render:function(){
  const htmls = this.songs.map(song=>{
    return `
        <div class="song_row">
            <img class="songRow_album" src="${song.image}" />
                <div class="songRow_info">
                   <h1>${song.name}</h1>
                      <p>${song.singer}</p>
                </div>
        </div>
    `
  })
playlist.html(htmls.join(''))
},
defineProperties:function(){
    Object.defineProperty(this,'currrentSong',{
        get:function(){
            return this.songs[this.currentIndex]
        }
    })
},
handleEvent:function(){
//Handle play/pause button

playBtn.click(function(){
    if($('.fa-play-circle').hasClass("my pause")){
        $('.fa-play-circle').removeClass("my pause")
        $('.fa-pause-circle').addClass("pause")
        audio.get(0).pause()
    }else{
        $('.fa-play-circle').addClass("my pause")
        $('.fa-pause-circle').removeClass("pause")
        audio.get(0).play()
        audio.get(0).ontimeupdate=function(){
            var s = parseInt(audio.get(0).currentTime % 60);
            var m = parseInt((audio.get(0).currentTime / 60) % 60);
        $('#start_time').html(m+':'+s)
        //progress of song
        if(audio.get(0).duration){
            const song_progress  = Math.floor(audio.get(0).currentTime / audio.get(0).duration*100)
            progress.css("width",song_progress+'%')
        }
        }
        var e = parseInt(audio.get(0).duration % 60);
        var d = parseInt((audio.get(0).duration / 60) % 60);
        $('#end_time').html(e+':'+d*10)
    }
    
})
    //function call next song
    var callback=()=> {
        //app.nextSong=app.nextSong.bind(this)
        app.nextSong()
        audio.get(0).play()
     }
    //function for prev song
     var onprev=()=>{
         app.prevSong()
         audio.get(0).play()
     }
    onprev=onprev.bind(this)
    callback=callback.bind(this)
    //Next Song
    prev_Btn.click(onprev)
    next_Btn.click(callback)

},



//load Song

loadCurrentSong: function(){
    audio.attr("src",this.currrentSong.path)
    player_thumb.attr("src",this.currrentSong.image)
    player_artis.html(this.currrentSong.singer)
    player_tittle.html(this.currrentSong.name)
},
//next Song
nextSong:function (){
    this.currentIndex++
    console.log(this,this.currentIndex)
    if(this.currentIndex>=this.songs.length){
        this.currentIndex=0
    }
      this.loadCurrentSong()
},

//prevSong
prevSong:function (){
    this.currentIndex--
    console.log(this,this.currentIndex)
    if(this.currentIndex<=0){
        this.currentIndex=0
    }
      this.loadCurrentSong()
},

start:function(){
  //define properties for object
  this.defineProperties()
  //load current Song
  this.loadCurrentSong()
  //render playlist
  this.render()
  this.handleEvent()
  }
}

app.start()
</script>